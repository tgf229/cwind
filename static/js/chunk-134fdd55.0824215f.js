(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-134fdd55"],{4381:function(t,e,a){"use strict";a("6762"),a("2fdb");var i=a("4360"),n={inserted:function(t,e,a){var n=e.value,s=i["a"].getters&&i["a"].getters.roles;if(!(n&&n instanceof Array&&n.length>0))throw new Error("need roles! Like v-permission=\"['admin','editor']\"");var o=n,l=s.some(function(t){return o.includes(t)});l||t.parentNode&&t.parentNode.removeChild(t)}},s=function(t){t.directive("permission",n)};window.Vue&&(window["permission"]=n,Vue.use(s)),n.install=s;e["a"]=n},"689c":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("div",{directives:[{name:"permission",rawName:"v-permission",value:["T002"],expression:"['T002']"}],staticClass:"filter-container"},[a("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-edit"},on:{click:t.handleCreate}},[t._v("创建小区")])],1),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading_list,expression:"loading_list"}],staticStyle:{width:"100%"},attrs:{data:t.list,fit:"",stripe:"",border:""}},[a("el-table-column",{attrs:{label:"序号",align:"center",sortable:"",type:"index",width:"50"}}),t._v(" "),a("el-table-column",{attrs:{prop:"communityName",align:"center",label:"小区名称"}}),t._v(" "),a("el-table-column",{attrs:{prop:"tel",align:"center",label:"客服电话"}}),t._v(" "),a("el-table-column",{attrs:{prop:"contactName",align:"center",label:"联系人"}}),t._v(" "),a("el-table-column",{attrs:{prop:"contactPhone",align:"center",label:"联系人电话"}}),t._v(" "),a("el-table-column",{attrs:{prop:"status",label:"状态",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return["1"==e.row.status?a("el-tag",{attrs:{type:"success"}},[t._v("启用")]):"0"==e.row.status?a("el-tag",{attrs:{type:"danger"}},[t._v("停用")]):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"address",align:"center",label:"地址","min-width":"200"}}),t._v(" "),a("el-table-column",{attrs:{fixed:"right",align:"center",label:"操作",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){return t.handleUpdate(e.$index,e.row)}}},[t._v("编辑")]),t._v(" "),"1"==e.row.status?a("el-button",{attrs:{size:"mini",type:"danger",disabled:t.loading_opt},on:{click:function(a){return t.handleOpenOrDelete(e.$index,e.row)}}},[t._v("停用")]):"0"==e.row.status?a("el-button",{attrs:{size:"mini",type:"success",disabled:t.loading_opt},on:{click:function(a){return t.handleOpenOrDelete(e.$index,e.row)}}},[t._v("启用")]):t._e()]}}])})],1),t._v(" "),a("pagination",{attrs:{total:t.total,page:t.listQuery.page,limit:t.listQuery.limit},on:{"update:page":function(e){return t.$set(t.listQuery,"page",e)},"update:limit":function(e){return t.$set(t.listQuery,"limit",e)},pagination:t.getList}}),t._v(" "),a("el-dialog",{attrs:{title:t.textMap[t.dialogStatus],visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[a("el-form",{ref:"dataForm",staticStyle:{width:"440px","margin-left":"50px"},attrs:{rules:t.rule,model:t.temp,"label-position":"left","label-width":"100px"}},[a("el-form-item",{attrs:{prop:"communityName",label:"小区名称"}},[a("el-input",{attrs:{type:"text",maxlength:"40",clearable:"",placeholder:"请输入小区名称"},model:{value:t.temp.communityName,callback:function(e){t.$set(t.temp,"communityName","string"===typeof e?e.trim():e)},expression:"temp.communityName"}})],1),t._v(" "),a("el-form-item",{attrs:{prop:"tel",label:"客服电话"}},[a("el-input",{attrs:{type:"text",maxlength:"20",clearable:"",placeholder:"请输入客服电话"},model:{value:t.temp.tel,callback:function(e){t.$set(t.temp,"tel","string"===typeof e?e.trim():e)},expression:"temp.tel"}})],1),t._v(" "),a("el-form-item",{attrs:{prop:"contactName",label:"联系人"}},[a("el-input",{attrs:{type:"text",maxlength:"20",clearable:"",placeholder:"请输入联系人姓名"},model:{value:t.temp.contactName,callback:function(e){t.$set(t.temp,"contactName","string"===typeof e?e.trim():e)},expression:"temp.contactName"}})],1),t._v(" "),a("el-form-item",{attrs:{prop:"contactPhone",label:"联系人电话"}},[a("el-input",{attrs:{type:"text",maxlength:"20",clearable:"",placeholder:"请输入联系人手机号"},model:{value:t.temp.contactPhone,callback:function(e){t.$set(t.temp,"contactPhone","string"===typeof e?e.trim():e)},expression:"temp.contactPhone"}})],1),t._v(" "),a("el-form-item",{attrs:{prop:"location",label:"省/市/区"}},[a("el-cascader",{attrs:{options:t.options,"change-on-select":"",size:"medium"},model:{value:t.temp.location,callback:function(e){t.$set(t.temp,"location",e)},expression:"temp.location"}})],1),t._v(" "),a("el-form-item",{attrs:{prop:"address",label:"小区地址"}},[a("el-input",{attrs:{autosize:{minRows:2,maxRows:4},type:"textarea",maxlength:"100",clearable:"",placeholder:"请输入小区地址"},model:{value:t.temp.address,callback:function(e){t.$set(t.temp,"address","string"===typeof e?e.trim():e)},expression:"temp.address"}})],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取消")]),t._v(" "),a("el-button",{attrs:{type:"primary",loading:t.loading_submit},nativeOn:{click:function(e){e.preventDefault(),"create"===t.dialogStatus?t.createData():t.updateData()}}},[t._v("提交")])],1)],1)],1)},n=[],s=a("4381"),o=a("333d"),l=a("7998"),r=a("425e"),c={name:"community",components:{Pagination:o["a"]},directives:{permission:s["a"]},data:function(){return{loading_list:!1,loading_submit:!1,loading_opt:!1,options:r["a"],list:null,total:0,listQuery:{pagination:!0,page:1,limit:10},temp:{communityName:"",tel:"",contactName:"",contactPhone:"",address:"",location:[],status:"1"},dialogFormVisible:!1,dialogStatus:"",textMap:{update:"编辑",create:"创建小区"},rule:{communityName:[{required:!0,message:"请输入小区名称",trigger:"blur"}],tel:[{required:!0,message:"请输入客服电话",trigger:"blur"}],contactName:[{required:!0,message:"请输入联系人姓名",trigger:"blur"}],contactPhone:[{required:!0,message:"请输入联系方式",trigger:"blur"}],address:[{required:!0,message:"请输入小区地址",trigger:"blur"}],location:[{type:"array",min:3,message:"请选择省市区",required:!0,trigger:"change"}]}}},created:function(){this.getList()},methods:{getList:function(){var t=this;this.loading_list=!0,Object(l["b"])(this.listQuery).then(function(e){t.loading_list=!1,t.list=e.list,t.total=e.count}).catch(function(e){t.loading_list=!1,t.$message({center:!0,message:e,type:"error"})})},handleOpenOrDelete:function(t,e){var a=this;if(this.loading_opt=!0,this.temp=Object.assign({},e),this.temp.index=t,this.temp.status="0"==this.temp.status?"1":"0",!this.temp.location){var i=[];i.push(this.temp.province),i.push(this.temp.city),i.push(this.temp.area),this.temp.location=i}Object(l["c"])(this.temp).then(function(t){a.$message({center:!0,message:"操作成功",type:"success"}),setTimeout(function(){a.list.splice(a.temp.index,1,a.temp),a.loading_opt=!1},2e3)}).catch(function(t){a.$message({center:!0,message:t,type:"error"}),setTimeout(function(){a.loading_opt=!1},2e3)})},resetTemp:function(){this.temp={communityName:"",tel:"",contactName:"",contactPhone:"",address:"",location:[],status:"1"}},handleCreate:function(){var t=this;this.resetTemp(),this.dialogStatus="create",this.dialogFormVisible=!0,this.$nextTick(function(){t.$refs["dataForm"].clearValidate()})},createData:function(){var t=this;this.$refs["dataForm"].validate(function(e){e&&(t.loading_submit=!0,Object(l["a"])(t.temp).then(function(e){Object.assign(t.temp,{objectId:e.objectId})}).then(function(e){t.dialogFormVisible=!1,t.$message({center:!0,message:"创建小区成功",type:"success"}),t.list.push(t.temp),setTimeout(function(){t.loading_submit=!1},2e3)}).catch(function(e){t.$message({center:!0,message:e,type:"error"}),setTimeout(function(){t.loading_submit=!1},2e3)}))})},handleUpdate:function(t,e){var a=this;if(this.temp=Object.assign({},e),this.temp.index=t,!this.temp.location){var i=[];i.push(this.temp.province),i.push(this.temp.city),i.push(this.temp.area),this.temp.location=i}this.dialogStatus="update",this.dialogFormVisible=!0,this.$nextTick(function(){a.$refs["dataForm"].clearValidate()})},updateData:function(){var t=this;this.$refs["dataForm"].validate(function(e){e&&(t.loading_submit=!0,Object(l["c"])(t.temp).then(function(e){t.$message({center:!0,message:"编辑成功",type:"success"}),t.list.splice(t.temp.index,1,t.temp),t.dialogFormVisible=!1,setTimeout(function(){t.loading_submit=!1},2e3)}).catch(function(e){t.$message({center:!0,message:e,type:"error"}),setTimeout(function(){t.loading_submit=!1},2e3)}))})}}},m=c,p=a("2877"),u=Object(p["a"])(m,i,n,!1,null,null,null);e["default"]=u.exports}}]);