(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-a022313c"],{"0014":function(t,e,a){"use strict";var i=a("1a23"),n=a.n(i);n.a},"1a23":function(t,e,a){},bed6:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("div",{staticClass:"filter-container"},[a("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-edit"},on:{click:t.handleCreate}},[t._v("创建小区管理员")])],1),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading_list,expression:"loading_list"}],staticStyle:{width:"100%"},attrs:{data:t.list,fit:"",border:""}},[a("el-table-column",{attrs:{label:"序号",align:"center",sortable:"",type:"index",width:"50"}}),t._v(" "),a("el-table-column",{attrs:{prop:"username",align:"center",label:"登录名"}}),t._v(" "),a("el-table-column",{attrs:{prop:"name",align:"center",label:"姓名"}}),t._v(" "),a("el-table-column",{attrs:{prop:"role",align:"center",label:"身份"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tag",{attrs:{type:"info"}},[t._v("小区管理员")])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"status",label:"状态",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return["1"==e.row.status?a("el-tag",{attrs:{type:"success"}},[t._v("启用")]):"0"==e.row.status?a("el-tag",{attrs:{type:"danger"}},[t._v("停用")]):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"管理小区","min-width":"200"},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(e.row.communityNames,function(e,i){return a("span",{key:i},[a("el-tag",{attrs:{type:"warning"}},[t._v(t._s(e))]),t._v(" \n        ")],1)})}}])}),t._v(" "),a("el-table-column",{attrs:{fixed:"right",align:"center",label:"操作",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){return t.handleUpdate(e.$index,e.row)}}},[t._v("编辑")]),t._v(" "),"1"==e.row.status?a("el-button",{attrs:{size:"mini",type:"danger",disabled:t.loading_opt},on:{click:function(a){return t.handleOpenOrDelete(e.$index,e.row)}}},[t._v("停用")]):"0"==e.row.status?a("el-button",{attrs:{size:"mini",type:"success",disabled:t.loading_opt},on:{click:function(a){return t.handleOpenOrDelete(e.$index,e.row)}}},[t._v("启用")]):t._e()]}}])})],1),t._v(" "),a("pagination",{attrs:{total:t.total,page:t.listQuery.page,limit:t.listQuery.limit},on:{"update:page":function(e){return t.$set(t.listQuery,"page",e)},"update:limit":function(e){return t.$set(t.listQuery,"limit",e)},pagination:t.getList}}),t._v(" "),a("el-dialog",{attrs:{title:t.textMap[t.dialogStatus],visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[a("el-form",{ref:"dataForm",staticStyle:{width:"440px","margin-left":"50px"},attrs:{rules:t.rule,model:t.temp,"label-position":"left","label-width":"100px"}},["create"==t.dialogStatus?a("div",[a("el-form-item",{attrs:{prop:"username",label:"登录用户名"}},[a("el-input",{attrs:{type:"text",maxlength:"11",clearable:"",placeholder:"请输入小区管理员手机号码"},model:{value:t.temp.username,callback:function(e){t.$set(t.temp,"username","string"===typeof e?e.trim():e)},expression:"temp.username"}})],1),t._v(" "),a("el-form-item",{attrs:{prop:"captcha",label:"验证码"}},[a("el-col",{attrs:{span:14}},[a("el-input",{attrs:{type:"text",maxlength:"6",clearable:"",placeholder:"请输入验证码"},model:{value:t.temp.captcha,callback:function(e){t.$set(t.temp,"captcha","string"===typeof e?e.trim():e)},expression:"temp.captcha"}})],1),t._v(" "),a("el-button",{staticClass:"captcha",attrs:{type:"primary",plain:"",icon:"el-icon-message",loading:t.loading_captcha},on:{click:t.getCaptcha}},[t._v("获取验证码")])],1),t._v(" "),a("el-form-item",{attrs:{prop:"password",label:"密码"}},[a("el-input",{attrs:{type:"text",clearable:"",placeholder:"请输入登录密码",maxlength:"40","show-password":""},model:{value:t.temp.password,callback:function(e){t.$set(t.temp,"password","string"===typeof e?e.trim():e)},expression:"temp.password"}})],1),t._v(" "),a("el-form-item",{attrs:{prop:"name",label:"姓名"}},[a("el-input",{attrs:{type:"text",maxlength:"20",clearable:"",placeholder:"请输入小区管理员姓名"},model:{value:t.temp.name,callback:function(e){t.$set(t.temp,"name","string"===typeof e?e.trim():e)},expression:"temp.name"}})],1)],1):t._e(),t._v(" "),a("el-form-item",{attrs:{label:"管理小区",prop:"communityIds"}},[a("el-checkbox-group",{model:{value:t.temp.communityIds,callback:function(e){t.$set(t.temp,"communityIds",e)},expression:"temp.communityIds"}},t._l(t.communityList,function(e,i){return a("el-checkbox",{key:e.objectId,attrs:{label:e.objectId}},[t._v(t._s(e.communityName))])}),1)],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取消")]),t._v(" "),a("el-button",{attrs:{type:"primary",loading:t.loading_submit},nativeOn:{click:function(e){e.preventDefault(),"create"===t.dialogStatus?t.createData():t.updateData()}}},[t._v("提交")])],1)],1)],1)},n=[],s=(a("7f7f"),a("333d")),o=a("c24f"),l=a("7998"),r=(a("5f87"),a("425e")),c={name:"community",components:{Pagination:s["a"]},data:function(){return{communityList:[],temp:{username:"",captcha:"",password:"",name:"",communityIds:[],communityNames:[]},loading_captcha:!1,loading_list:!1,loading_submit:!1,loading_opt:!1,options:r["a"],list:[],total:0,listQuery:{pagination:!0,page:1,limit:10},dialogFormVisible:!1,dialogStatus:"",textMap:{update:"编辑",create:"创建小区管理员"},rule:{username:[{required:!0,min:11,message:"请输正确的小区管理员手机号码",trigger:"blur"}],captcha:[{required:!0,min:6,message:"请输入6位验证码",trigger:"blur"}],password:[{required:!0,min:6,message:"登录密码不应小于6位",trigger:"blur"}],name:[{required:!0,message:"请输入小区管理员姓名",trigger:"blur"}],communityIds:[{type:"array",message:"请至少选择一个小区",required:!0,trigger:"change"}]}}},created:function(){this.getList()},methods:{getCaptcha:function(){var t=this,e=this.temp.username;""===e?this.$message({center:!0,message:"请输入手机号码",type:"error"}):11!==e.length?this.$message({center:!0,message:"手机号码必须是11位数字",type:"error"}):(this.loading_captcha=!0,Object(o["a"])(e).then(function(e){t.$message({center:!0,message:"验证码已发送，请留意并填写验证码",type:"success"}),setTimeout(function(){t.loading_captcha=!1},2e3)}).catch(function(e){t.$message({center:!0,message:e,type:"error"}),setTimeout(function(){t.loading_captcha=!1},2e3)}))},getList:function(){var t=this;this.loading_list=!0,Object(l["b"])({pagination:!1}).then(function(e){return t.communityList=e.list,Object(o["f"])({pagination:!1})}).then(function(e){t.loading_list=!1,t.list=e.list,t.total=e.count}).catch(function(e){t.loading_list=!1,t.$message({center:!0,message:e,type:"error"})})},handleOpenOrDelete:function(t,e){var a=this;this.loading_opt=!0,this.temp=Object.assign({},e),this.temp.index=t,this.temp.status="0"==this.temp.status?"1":"0",Object(o["g"])(this.temp).then(function(t){a.$message({center:!0,message:"操作成功",type:"success"}),setTimeout(function(){a.list.splice(a.temp.index,1,a.temp),a.loading_opt=!1},2e3)}).catch(function(t){a.$message({center:!0,message:t,type:"error"}),setTimeout(function(){a.loading_opt=!1},2e3)})},resetTemp:function(){this.temp={username:"",captcha:"",password:"",name:"",communityIds:[],communityNames:[],status:"1"}},handleCreate:function(){var t=this;this.resetTemp(),this.dialogStatus="create",this.dialogFormVisible=!0,this.$nextTick(function(){t.$refs["dataForm"].clearValidate()})},createData:function(){var t=this;this.$refs["dataForm"].validate(function(e){if(e){t.loading_submit=!0;var a=[];for(var i in t.communityList)-1!=t.temp.communityIds.indexOf(t.communityList[i].objectId)&&a.push(t.communityList[i].communityName);t.temp.communityNames=a,Object(o["e"])({username:t.temp.username,password:t.temp.password,tel:t.temp.username,name:t.temp.name,role:"T003",communityIds:t.temp.communityIds,communityNames:t.temp.communityNames}).then(function(e){Object.assign(t.temp,{objectId:e.objectId}),t.dialogFormVisible=!1,t.$message({center:!0,message:"创建小区管理员成功",type:"success"}),t.list.push(t.temp),setTimeout(function(){t.loading_submit=!1},2e3)}).catch(function(e){t.$message({center:!0,message:e,type:"error"}),setTimeout(function(){t.loading_submit=!1},2e3)})}})},handleUpdate:function(t,e){var a=this;this.temp=Object.assign({},e),this.temp.index=t,this.dialogStatus="update",this.dialogFormVisible=!0,this.$nextTick(function(){a.$refs["dataForm"].clearValidate()})},updateData:function(){var t=this;this.$refs["dataForm"].validate(function(e){if(e){t.loading_submit=!0;var a=[];for(var i in t.communityList)-1!=t.temp.communityIds.indexOf(t.communityList[i].objectId)&&a.push(t.communityList[i].communityName);t.temp.communityNames=a,Object(o["g"])(t.temp).then(function(e){t.$message({center:!0,message:"编辑成功",type:"success"}),t.list.splice(t.temp.index,1,t.temp),t.dialogFormVisible=!1,setTimeout(function(){t.loading_submit=!1},2e3)}).catch(function(e){t.$message({center:!0,message:e,type:"error"}),setTimeout(function(){t.loading_submit=!1},2e3)})}})}}},m=c,u=(a("0014"),a("2877")),p=Object(u["a"])(m,i,n,!1,null,"7c6289e6",null);e["default"]=p.exports}}]);